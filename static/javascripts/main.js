var $carouselContent=null,carouselIsAnimate=null,carouselIndex=null,carouselContentChild=null,carouselLength=null,carouselLastItem=null,carouselFirstItem=null,autoSlide=null,first_submenu_load=!0;function hidePreload(){$("#preloader").fadeOut("slow",function(){$("body").css({overflow:"visible"}),startPage()})}function startPage(){$(".background-paralax .slogan").animate({opacity:"1"},700)}function autoRotateSlide(){autoSlide=setInterval(function(){slideRight()},2500)}function slideRight(){carouselIsAnimate||(carouselIsAnimate=!0,++carouselIndex>=carouselLength?(carouselContentChild.each(function(e){$(this).animate({left:e*$(this).width()},1e3,function(){carouselIsAnimate=!1})}),carouselIndex=0):carouselContentChild.each(function(e){$(this).animate({left:$(this).position().left-$(this).width()},1e3,function(){carouselIsAnimate=!1})}))}function slideLeft(e){carouselIsAnimate||(carouselIsAnimate=!0,--carouselIndex<0?(carouselContentChild.each(function(e){$(this).animate({left:$(this).position().left-(carouselLength-1)*$(this).width()},1e3,function(){carouselIsAnimate=!1})}),carouselIndex=carouselLength-1):carouselContentChild.each(function(e){$(this).animate({left:$(this).position().left+$(this).width()},1e3,function(){carouselIsAnimate=!1})}))}function slideTo(e,t){var n=e.find(".item");n.length;n.each(function(t,n){$(n).hasClass("active"),e.width(),$(n).position()})}function bindPlateEvents(){$(".plate_new").each(function(){$(this).css({"min-height":"286px",height:"286px","max-height":"286px"})})}$(document).ready(function(){hidePreload();$(window).scrollTop();var e=$(window).height(),t=($("#atm-header"),$("#atm-header-slogan-section .parallax-img"));($carouselContent=$("#scenery-carousel .content")).css({height:$carouselContent.width()/3}),carouselIsAnimate=!1,carouselIndex=0,carouselContentChild=$carouselContent.children(),carouselLength=carouselContentChild.length,carouselLastItem=carouselContentChild[carouselLength-1],carouselFirstItem=$carouselContent.children()[0],$(".carousel-control.left").on("click",function(e){slideLeft()}),$(".carousel-control.right").on("click",function(e){slideRight()}),$("#scenery-carousel").on("mouseover",function(){clearInterval(autoSlide)}).on("mouseout",function(){autoRotateSlide()}),autoRotateSlide();var n=e;$(window).on("resize",function(){e=$(window).height(),n=e});var a=[];$(".team-block-image").each(function(e){a.push([$(this),$(this).offset().top])}),$(window).scroll(function(o){var i=$(this).scrollTop();requestAnimationFrame(function(){var o;if(i<=n&&(o=i,t.css("top",.5*o+"px")),a.length){var s=[];a.forEach(function(t,n){i+e/2>t[1]&&(t[0].animate({opacity:1},600),s.push(n))}),s.forEach(function(e){a.splice(e,1)})}}),i});var o=$(".atm-navigation__bg-img");o&&($navContainer=$(".atm-nav-container"),o.css({height:$navContainer[0].offsetHeight+20,width:$navContainer[0].offsetWidth+20,left:-(Number($navContainer.css("padding-left").replace("px",""))+10),display:"block"})),bindPlateEvents(),bindAjaxContentChange(),bindAjaxReservedForm(),$("body").on("click",function(e){if($(e.target).hasClass(".atm-overlay"))return $(".atm-overlay").remove(),$(".atm-reserved-form").remove(),void $("body").css("overflow","auto");$(".atm-nav_mobile").hasClass("active")&&$(".atm-nav_mobile").removeClass("active")}),$(".atm-menu-mobile__btn").on("click",function(e){e.preventDefault(),e.stopPropagation(),$(this).closest(".atm-nav-container_mobile").toggleClass("active"),$(".atm-menu-submenu-btn_mobile").removeClass("active").next(".atm-menu-submenu_mobile").slideUp().end().children("i").removeClass("active")}),$(".atm-nav_mobile").on("click",function(e){e.stopPropagation()}),$(".atm-menu-submenu-btn_mobile").on("click",function(e){$(this).hasClass("active")?$(this).removeClass("active").next(".atm-menu-submenu_mobile").slideUp().end().children("i").removeClass("active"):$(this).addClass("active").next(".atm-menu-submenu_mobile").slideDown().end().children("i").addClass("active")})});var subMenuContentAction={graduations:{url:"/graduations/graduationschange/",default:"school",success:function(e){$("#graduations_images").html(e.html)}},sessions:{url:"/halls/sessionschange/",default:"family",success:function(e){$("#session").html(e.html),$("#title").html(e.title),$("#desc").html(e.desc)}},halls:{url:"/halls/hallschange/",default:"dark",success:function(e){console.log(e),$("#hall").html(e.html),$("#title").html(e.title),$("#desc").html(e.desc),$("#hallsize").html("Размер зала: "+e.hallsize+" кв.м."),$("#price").html("Стоимость аренды зала: <br>"+e.price+"руб./час")}}};function bindAjaxContentChange(){var e=window.location.pathname.replace(/\//g,"");e in subMenuContentAction&&(changeSubMenuContent(subMenuContentAction[e].default),$(".view").first().addClass("active").end().on("click",function(e){e.preventDefault(),$(".view").removeClass("active"),changeSubMenuContent.call(this)}))}function bindAjaxReservedForm(){$(".reserved-btn").on("click",function(e){e.preventDefault(),$.ajax({type:"GET",url:"/reserved/form",dataType:"json",cache:!1,success:function(e){if("ok"===e.response){createOverlay();var t=$(e.html);t.css({top:$(window).scrollTop()+20}).find(".fa-times").on("click",function(){$(".atm-overlay").remove(),$(".atm-reserved-form").remove(),$("body").css("overflow","auto")}).end().find(".atm-form__phone").mask("+7(999) 999-9999"),$("body").css("overflow","hidden").append(t)}}})})}function createOverlay(){$("<div></div>").addClass("atm-overlay").appendTo("body")}function changeSubMenuContent(e){var t=window.location.pathname.replace(/\//g,"");if((e=e||$(this).attr("data-desc"))&&t in subMenuContentAction){$(this).addClass("active");var n=subMenuContentAction[t];$.ajax({type:"GET",url:n.url,data:{view:e},dataType:"json",cache:!1,success:function(e){"ok"==e.response&&(n.success(e),first_submenu_load?first_submenu_load=!1:$("html").animate({scrollTop:$(".atm-under-menu").offset().top},500))}})}}jQuery(document).ready(function(e){var t=document.location.href.split("://")[1].split("/")[1];e.ajax({type:"GET",url:"/"+t+"/",data:{view:t},dataType:"json",cache:!1,success:function(t){"ok"==t.response&&(e("#desc_image").attr("src",t.image_src),e("#title").html(t.title),e("#main_text").html(t.main_text))}})});